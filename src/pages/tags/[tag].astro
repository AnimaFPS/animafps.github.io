---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

export async function getStaticPaths() {

    const allPosts = await Astro.glob('../*.md');
    return [
        { params: { tag: "comp-sci" }, props: {posts: allPosts} },
		{ params: { tag: "maths" }, props: {posts: allPosts} },
		{ params: { tag: "philosophy" }, props: {posts: allPosts} },
		{ params: { tag: "gaming" }, props: {posts: allPosts} },
		{ params: { tag: "aiming" }, props: {posts: allPosts} },
		{ params: { tag: "guides" }, props: {posts: allPosts} },
		{ params: { tag: "meta" }, props: {posts: allPosts} },
		{ params: { tag: "queer-theory" }, props: {posts: allPosts} },
		{ params: { tag: "essays" }, props: {posts: allPosts} },
		{ params: { tag: "periphirals" }, props: {posts: allPosts} }
    ];
    
}

const { tag } = Astro.params;
const { posts } = Astro.props;
const description = "Posts tagged with "+tag;
const filteredPosts = posts.filter((post) => post.frontmatter.tags.includes(tag));
---

<!DOCTYPE html>
<html lang="en-us">
	<head>
		<BaseHead title={tag} description={description} />
		<style>
			ul {
				list-style-type: none;
				padding: unset;
			}
			ul li {
				display: flex;
			}
			ul li time {
				flex: 0 0 130px;
				font-style: italic;
				color: #888;
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<content>
                <p>Posts tagged with {tag}</p>
                <ul>
                    {filteredPosts.map((post) => <li>
						<time datetime={post.frontmatter.date}>
							{new Date(post.frontmatter.date).toLocaleDateString('en-us', {
								year: 'numeric',
								month: 'short',
								day: 'numeric',
							})}
						</time>
						<a href={post.url}>{post.frontmatter.title}</a>
					</li>)}
                </ul>
            </content>
			<Footer />
		</main>
	</body>
</html>